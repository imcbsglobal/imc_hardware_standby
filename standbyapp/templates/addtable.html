<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Item List</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
  body {
    font-family: Arial, sans-serif;
    background: #f4f8fb;
    margin: 0;
    padding: 20px;
  }

  /* Header Container */
  .header-container {
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    margin-bottom: 15px;
  }

  .header-container h2 {
    margin: 0;
    font-size: 28px;
    color: #333;
    font-weight: bold;
    text-align: center;
    width: 100%;
  }

  .add-btn {
    position: absolute;
    right: 0;
    background:black;
    color: #fff;
    padding: 10px 18px;
    text-decoration: none;
    border-radius: 6px;
    font-size: 14px;
    font-weight: bold;
    transition: background 0.3s;
  }

  .add-btn:hover {
    background: #0056b3;
  }

  /* Search Form */
  .search-container {
    margin-bottom: 20px;
    background: #fff;
    padding: 12px 15px;
    border-radius: 6px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.05);
  }

  .search-container form {
    display: flex;
    gap: 10px;
  }

  .search-container input {
    flex: 1;
    padding: 10px 12px;
    border: 1px solid #ccc;
    border-radius: 6px;
    font-size: 14px;
    outline: none;
  }

  .search-container button {
    background: black;
    color: #fff;
    border: none;
    padding: 10px 16px;
    border-radius: 6px;
    font-size: 14px;
    cursor: pointer;
    transition: background 0.3s;
  }

  .search-container button:hover {
    background: #0056b3;
  }

  /* Table Styling */
  table {
    width: 100%;
    border-collapse: collapse;
    background: #fff;
    margin-top: 10px;
  }

  th, td {
    border: 1px solid #ccc;
    padding: 12px 14px;
    font-size: 14px;
    text-align: left;
  }

  th {
    text-align: center;
    background: black;
    color: #fff;
    font-size: 16px;
    font-weight: bold;
    text-transform: uppercase;
  }

  tbody tr:hover td {
    background: #f9fbfd;
  }
</style>
</head>
<body>

<!-- Header and Add Button -->
<div class="header-container">
  <h2>StandBy Product</h2>
  <a href="{% url 'add' %}" class="add-btn"><i class="fas fa-plus"></i> Add New</a>
</div>

<!-- Search Form -->
<div class="search-container">
  <form method="get" action="">
    <input type="text" name="search" value="{{ request.GET.search }}" placeholder="Search by Name or Serial Number...">
    <button type="submit"><i class="fas fa-search"></i> Search</button>
  </form>
</div>

<!-- Table -->
<table>
<thead>
<tr>
  <th>Sl.No.</th>
  <th>Created Date</th>
  <th>Item Name</th>
  <th>Serial Number</th>
  <th>Notes</th>
  <th>Images</th>
  <th>Stock</th>
  <th>Created By</th>
  <th>Actions</th>
</tr>
</thead>
<tbody>
{% for item in items %}
<tr>
  <td>{{ forloop.counter }}</td>
  <td>{{ item.created_at|date:"d M Y" }}</td>
  <td>{{ item.name }}</td>
  <td>{{ item.serial_number }}</td>
  <td>
    {% if item.notes %}
      <span style="display:inline-block;background:#007bff;color:#fff;border-radius:50%;width:24px;height:24px;text-align:center;line-height:24px;cursor:pointer;"
            onclick="openModal('{{ item.name|escapejs }}', '{{ item.notes|escapejs }}')">i</span>
    {% else %}
      <span style="color:#888;">â€”</span>
    {% endif %}
  </td>
  <td>
    {% if item.images.all %}
      {% for img in item.images.all %}
        <img src="{{ img.image.url }}" alt="{{ item.name }}" style="width:40px;height:40px;border-radius:4px;border:1px solid #ccc;object-fit:cover;">
      {% endfor %}
    {% else %} No Images {% endif %}
  </td>
  <td>{{ item.stock }}</td>
  <td>{{ item.created_by.username }}</td>
  <td>
    <a href="{% url 'item_edit' item.id %}" style="color:#28a745;font-size:18px;margin-right:6px;"><i class="fas fa-edit"></i></a>
    <form action="{% url 'item_delete' item.id %}" method="POST" style="display:inline;">
      {% csrf_token %}
      <button type="submit" style="color:#dc3545;background:none;border:none;font-size:18px;cursor:pointer;" onclick="return confirm('Are you sure?');"><i class="fas fa-trash-alt"></i></button>
    </form>
  </td>
</tr>
{% empty %}
<tr><td colspan="9" style="text-align:center;">No items found</td></tr>
{% endfor %}
</tbody>
</table>

<!-- Modal -->
<div id="notesModal" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.6);justify-content:center;align-items:center;">
  <div style="background:#fff;padding:20px;border-radius:6px;max-width:500px;width:90%;position:relative;">
    <span onclick="closeModal()" style="position:absolute;top:10px;right:12px;cursor:pointer;font-size:20px;">&times;</span>
    <h3 id="modalTitle">Notes</h3>
    <p id="modalText"></p>
  </div>
</div>

<script>
const modal = document.getElementById('notesModal');
const modalTitle = document.getElementById('modalTitle');
const modalText = document.getElementById('modalText');

function openModal(itemName, notes) {
  modalTitle.innerText = itemName + ' - Notes';
  modalText.innerText = notes;
  modal.style.display = 'flex';
}
function closeModal() { modal.style.display = 'none'; }
window.onclick = function(e) { if (e.target === modal) closeModal(); }
</script>

</body>
</html>
